<!DOCTYPE html><html lang="en-US"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>Use git-mv to Rename or Move a File | Ox333333</title><meta name="description" content="Use git mv to rename or move a file to preserve file update history and prevent merge mistakes."><meta name="keywords"><meta name="subtitle" content="In Pursuit of Absolute Simplicity"><meta name="author" content="Ox333333"><meta name="google-site-verification" content="cvPAyZ-ZCL95oXwVejN2W-cxTBfUemEGQOnHKDEQ8Dk"><meta name="msvalidate.01" content="31FA25C5697C3CA088656A9B63A9013F"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="og:site_name" content="Ox333333"><meta name="og:type" content="website"><meta name="og:title" content="Use git-mv to Rename or Move a File"><meta name="og:descricption" content="Use git mv to rename or move a file to preserve file update history and prevent merge mistakes."><meta name="og:url" content="https://zpjiang.me/2020/01/12/git-mv/"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Use git-mv to Rename or Move a File"><meta name="twitter:description" content="Use git mv to rename or move a file to preserve file update history and prevent merge mistakes."><meta name="twitter:site" content="@Ox333333"><meta name="twitter:url" content="https://zpjiang.me/2020/01/12/git-mv/"><link rel="canonical" href="https://zpjiang.me/2020/01/12/git-mv/"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://zpjiang.me/atom.xml" title="Ox333333"><meta name="generator" content="Hexo 5.4.0"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="https://blog.1pixel.cc" target="_blank" class="nav-list-link">TRAVEL</a></li><li class="nav-list-item"><a href="https://1pixel.cc" target="_blank" class="nav-list-link">PHOTOGRAPHY</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Use git-mv to Rename or Move a File</h1><div class="post-info">Jan 12, 2020</div><div class="post-content"><h2 id="Tl-dr"><a href="#Tl-dr" class="headerlink" title="Tl;dr"></a>Tl;dr</h2><p>Use</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git mv [source_file] [destination_file]</span><br></pre></td></tr></table></figure>
<p>to rename or move a file instead of renaming or moving a file directly (e.g. from IDE, or via <code>mv</code>). This is helpful for preserving history and potentially helpful for preventing merge mistakes.</p>
<span id="more"></span>
<h2 id="What’s-git-mv"><a href="#What’s-git-mv" class="headerlink" title="What’s git mv"></a>What’s git mv</h2><p>According to <a target="_blank" rel="noopener" href="https://git-scm.com/docs/git-mv">Git - git-mv Documentation</a>,</p>
<blockquote>
<p>git-mv - Move or rename a file, a directory, or a symlink.</p>
</blockquote>
<h2 id="Why-can’t-we-just-rename-or-move-a-file-directly"><a href="#Why-can’t-we-just-rename-or-move-a-file-directly" class="headerlink" title="Why can’t we just rename or move a file directly?"></a>Why can’t we just rename or move a file directly?</h2><p>Sure, renaming or moving a file can be done simply via <code>mv</code> command or a few clicks in a IDE/Editor, but there are a few downsides and potential risks.</p>
<p>For example, we have a repo with only one file <code>test.txt</code>, there are two commits in log.</p>
<p><img src="https://raw.githubusercontent.com/0x333333/blog_img/master/z_git_repo.png" alt="repo"></p>
<p><img src="https://raw.githubusercontent.com/0x333333/blog_img/master/z_git_log.png" alt="repo log"></p>
<p>If we move the file using <code>mv</code> command, and make some change in the new file, <code>git status</code> would show the old file was deleted, new file was created. It looks perfectly normal, doesn’t it?</p>
<p><img src="https://raw.githubusercontent.com/0x333333/blog_img/master/z_git_status.png" alt="git status"></p>
<p>Not quite, if we check the diff, e.g. <code>git diff</code>, you would only see new file was created, old file was deleted, there is no liason between the two, it’s not easy to find the actual code change, bug could be introduced without much attention.</p>
<p>Besides, between the commit #2 and #3, if someone just submitted a change on the old file, before you submit #3 you would need <code>git rebase</code> or <code>git merge</code>, then submit your commit as #4. But wait, how do you replicate the change on the old file to the new file you just created? Manual copy-paste with human-eye-checking? What if it’s a big change?</p>
<h2 id="How-to-make-this-right"><a href="#How-to-make-this-right" class="headerlink" title="How to make this right?"></a>How to make this right?</h2><p>You need <code>git mv</code>.</p>
<p>With this, git will help you to track the connection between the old and the new files.</p>
<p><img src="https://raw.githubusercontent.com/0x333333/blog_img/master/z_git_mv_status.png" alt="git mv status"></p>
<p>Right now, the change is clearly presented in the diff.</p>
<p><img src="https://raw.githubusercontent.com/0x333333/blog_img/master/z_git_mv_diff.png" alt="git mv diff"></p>
<p>If someone submitted the commit before you submit the new file, after the rebasing or merging, you should be able to see everything clearly, what file was deleted, what change was made by your teammate on the old file, what you just added in the new file, etc.</p>
<h2 id="To-sum-up"><a href="#To-sum-up" class="headerlink" title="To sum up"></a>To sum up</h2><p>Use <code>git mv</code> to rename or move a file, it helps to preserve the full history and prevent potential merge mistakes.</p>
<p>By the way, right now Git is smart enough to find the liason between the old and new files, even if it’s done via <code>mv</code> or from a IDE/Editor, it checks if the two files are sharing the majority parts or not.</p>
<p>However, it’s always safer by using <code>git mv</code>.</p>
</div></article></div></section><footer><div class="paginator"><a href="/2020/01/15/let-baidu-index-github-page/" class="prev">上一篇</a><a href="/2019/12/31/florida/" class="next">下一篇</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'zhipeng';
var disqus_identifier = '2020/01/12/git-mv/';
var disqus_title = 'Use git-mv to Rename or Move a File';
var disqus_url = 'http://zpjiang.me/2020/01/12/git-mv/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//zhipeng.disqus.com/count.js" async></script><div class="copyright"><p>2013 - 2021 | <a href="http://zpjiang.me">Ox333333</a> <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/3.0/">| CC BY-NC-SA</a></p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script async data-ad-client="ca-pub-9383149074803575" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-47515905-1",'auto');ga('send','pageview');</script></body></html>